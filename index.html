<!DOCTYPE html>
<html lang="nb">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ready Player One - Class Skills</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- CSS-filer -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/achievements.css">
    <link rel="stylesheet" href="css/items.css">
    <link rel="stylesheet" href="css/quests.css">
    <link rel="stylesheet" href="css/bossfights.css">
</head>
<body>
    <audio id="achievementSound" src="sounds/achievement.mp3" preload="auto"></audio>
    <audio id="levelUpSound" src="https://www.soundjay.com/button/sounds/button-09.mp3" preload="auto"></audio>
    <audio id="itemFoundSound" src="sounds/item.mp3" preload="auto"></audio>

    <!-- Login-knapp -->
    <div style="position: absolute; top: 20px; right: 20px; z-index: 1000; display: flex; gap: 10px;">
        <a href="pages/dashboard.html" style="
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9));
            border: 2px solid #3498db;
            color: #3498db;
            padding: 8px 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);">
            <i class="fas fa-tachometer-alt"></i> Dashbord
        </a>
        <a href="pages/login.html" style="
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9));
            border: 2px solid #0ff;
            color: #0ff;
            padding: 8px 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);">
            <i class="fas fa-user"></i> Logg inn
        </a>
    </div>

    <!-- Importer Supabase JavaScript bibliotek først -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Importer vår felles Supabase-klient -->
    <script src="js/supabase/supabase-client.js"></script>
    
    <!-- Importer vår database-tjeneste -->
    <script src="js/services/database-service.js"></script>
    
    <!-- Importer våre egne JavaScript-filer -->
    <script src="js/students.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/main.js"></script>
    <script src="js/items.js"></script>
    <script src="js/shop.js"></script>
    <script src="js/quests.js"></script>
    <script src="js/npc.js"></script>
    <script src="js/bossfights.js"></script>
    <script src="js/events.js"></script>
    <script src="js/inventory-buttons.js"></script>
    <script src="js/marketplace.js"></script>
    <script src="js/combined-shop.js"></script>

    <script>
        // Global feilhåndtering
        window.onerror = function(message, source, lineno, colno, error) {
            console.error('Global feil fanget:', message, 'på linje', lineno, 'i', source);
            console.error('Feilobjekt:', error);
            
            // Vis en feilmelding til brukeren
            if (typeof showStylizedAlert === 'function') {
                showStylizedAlert('Det oppstod en feil: ' + message, 'error');
            }
            
            return false; // La nettleseren håndtere feilen videre
        };
        
        // Feilsøking
        window.onload = function() {
            console.log('Side lastet');
            if (typeof triggerRandomEvent === 'function') {
                console.log('triggerRandomEvent funksjonen er tilgjengelig');
            } else {
                console.error('triggerRandomEvent funksjonen er ikke tilgjengelig');
            }
            
            // Manuelt legg til knapper hvis de ikke allerede er lagt til
            if (typeof manuallyAddButtons === 'function') {
                setTimeout(manuallyAddButtons, 1500);
            }
            
            // Sjekk om updateTable er definert
            if (typeof updateTable === 'function') {
                console.log('updateTable funksjonen er tilgjengelig');
            } else {
                console.error('updateTable funksjonen er ikke tilgjengelig');
            }
            
            // Sjekk om students-arrayen er definert
            if (typeof students !== 'undefined' && Array.isArray(students)) {
                console.log('students-arrayen er tilgjengelig med', students.length, 'studenter');
            } else {
                console.error('students-arrayen er ikke tilgjengelig eller er ikke et array');
            }
        };
    </script>

    <h1 style="font-size: 36px; display: flex; align-items: center; justify-content: center; gap: 20px; cursor: pointer; position: relative;" onclick="showOasisModal()" title="Klikk for å lære mer om OASIS">
        <img src="player.png" alt="Player Icon" style="width: 90px; height: 60px;">
        OASIS - LEVEL UP FACILITY
        <img src="player.png" alt="Player Icon" style="width: 90px; height: 60px;">
        <i class="fas fa-info-circle info-pulse" style="position: absolute; right: -30px; top: 50%; transform: translateY(-50%); font-size: 18px; color: #3498db; opacity: 0.8;"></i>
    </h1>

    <!-- Ny hendelsesknapp -->
    <div style="display: flex; justify-content: center; margin: 20px 0; position: relative; z-index: 100;">
        <button onclick="triggerRandomEvent()" style="
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9)); 
            border: 2px solid #0ff; 
            color: #0ff; 
            padding: 15px 30px; 
            border-radius: 8px; 
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            z-index: 1000;"
            onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 20px rgba(0, 255, 255, 0.5)';"
            onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 15px rgba(0, 255, 255, 0.3)';">
            <i class="fas fa-dice" style="font-size: 20px;"></i>
            <span>Tilfeldig Hendelse</span>
            <div style="
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.3), transparent);
                animation: shineEffect 2s infinite;
                z-index: -1;
            "></div>
        </button>
        <button id="shopButton" onclick="openShopModal()" style="
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9)); 
            border: 2px solid #f1c40f; 
            color: #f1c40f; 
            padding: 15px 30px; 
            border-radius: 8px; 
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(241, 196, 15, 0.5);
            box-shadow: 0 0 15px rgba(241, 196, 15, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            z-index: 1000;
            margin-left: 15px;"
            onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 20px rgba(241, 196, 15, 0.5)';"
            onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 15px rgba(241, 196, 15, 0.3)';">
            <div style="display: flex; align-items: center; gap: 5px;">
                <i class="fas fa-store" style="font-size: 20px;"></i>
                <i class="fas fa-exchange-alt" style="font-size: 16px;"></i>
            </div>
            <span>OASIS Handelssenter</span>
            <div style="
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(241, 196, 15, 0.3), transparent);
                animation: shineEffect 2s infinite;
                z-index: -1;
            "></div>
        </button>
        <button id="npcButton" onclick="openNPCPanel()" style="
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9)); 
            border: 2px solid #3498db; 
            color: #3498db; 
            padding: 15px 30px; 
            border-radius: 8px; 
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            z-index: 1000;
            margin-left: 15px;"
            onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 20px rgba(52, 152, 219, 0.5)';"
            onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.3)';">
            <i class="fas fa-users" style="font-size: 20px;"></i>
            <span>NPCer</span>
            <div style="
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(52, 152, 219, 0.3), transparent);
                animation: shineEffect 2s infinite;
                z-index: -1;
            "></div>
        </button>
        <button id="oasisUpdateButton" onclick="openOASISUpdateModal()" style="
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9)); 
            border: 2px solid #9b59b6; 
            color: #9b59b6; 
            padding: 15px 30px; 
            border-radius: 8px; 
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(155, 89, 182, 0.5);
            box-shadow: 0 0 15px rgba(155, 89, 182, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            z-index: 1000;
            margin-left: 15px;"
            onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 20px rgba(155, 89, 182, 0.5)';"
            onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 15px rgba(155, 89, 182, 0.3)';">
            <i class="fas fa-newspaper" style="font-size: 20px;"></i>
            <span>OASIS Update</span>
            <div style="
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(155, 89, 182, 0.3), transparent);
                animation: shineEffect 2s infinite;
                z-index: -1;
            "></div>
        </button>
    </div>

    <div class="container" style="position: relative; z-index: 1;">
        <table>
            <thead>
                <tr>
                    <th>Spiller <button id="sortLevelBtn" class="sort-button" title="Sorter etter nivå"><i class="fas fa-sort"></i></button></th>
                    <th data-skill="Intelligens">Intelligens</th>
                    <th data-skill="Teknologi">Teknologi</th>
                    <th data-skill="Stamina">Stamina</th>
                    <th data-skill="Karisma">Karisma</th>
                    <th data-skill="Kreativitet">Kreativitet</th>
                    <th data-skill="Flaks">Flaks</th>
                    <th class="exp-header">EXP <button onclick="resetAllExp()">Reset All</button></th>
                </tr>
            </thead>
            <tbody id="skillsTableBody"></tbody>
        </table>
        
        <!-- Knapper under tabellen -->
        <div class="table-controls" style="
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        ">
            <button id="refreshButton" class="action-button" onclick="forceRefreshFromSupabase()" style="
                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                border: 2px solid #3498db; 
                color: #3498db; 
                padding: 12px 25px; 
                border-radius: 8px; 
                font-family: 'Courier New', monospace;
                text-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
                box-shadow: 0 0 10px rgba(52, 152, 219, 0.2);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 16px;
                text-transform: uppercase;
                letter-spacing: 1px;"
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.4)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(52, 152, 219, 0.2)';">
                <i class="fas fa-sync-alt" style="margin-right: 8px;"></i> Oppdater fra database
            </button>
            <button id="addPlayersButton" class="action-button" onclick="openAddPlayersModal()" style="
                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                border: 2px solid #27ae60; 
                color: #27ae60; 
                padding: 12px 25px; 
                border-radius: 8px; 
                font-family: 'Courier New', monospace;
                text-shadow: 0 0 5px rgba(39, 174, 96, 0.5);
                box-shadow: 0 0 10px rgba(39, 174, 96, 0.2);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 16px;
                text-transform: uppercase;
                letter-spacing: 1px;"
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(39, 174, 96, 0.4)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(39, 174, 96, 0.2)';">
                <i class="fas fa-user-plus" style="margin-right: 8px;"></i> Legg til spillere
            </button>
            <button id="exportButton" class="action-button" onclick="exportData()" style="
                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                border: 2px solid #3498db; 
                color: #3498db; 
                padding: 12px 25px; 
                border-radius: 8px; 
                font-family: 'Courier New', monospace;
                text-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
                box-shadow: 0 0 10px rgba(52, 152, 219, 0.2);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 16px;
                text-transform: uppercase;
                letter-spacing: 1px;"
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.4)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(52, 152, 219, 0.2)';">
                <i class="fas fa-file-export" style="margin-right: 8px;"></i> Eksporter data
            </button>
            <button id="importButton" class="action-button" onclick="importData()" style="
                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                border: 2px solid #9b59b6; 
                color: #9b59b6; 
                padding: 12px 25px; 
                border-radius: 8px; 
                font-family: 'Courier New', monospace;
                text-shadow: 0 0 5px rgba(155, 89, 182, 0.5);
                box-shadow: 0 0 10px rgba(155, 89, 182, 0.2);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 16px;
                text-transform: uppercase;
                letter-spacing: 1px;"
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(155, 89, 182, 0.4)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(155, 89, 182, 0.2)';">
                <i class="fas fa-file-import" style="margin-right: 8px;"></i> Importer data
            </button>
            <button id="resetButton" class="action-button" onclick="showPinDialog('resetAllExp')" style="
                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                border: 2px solid #e74c3c; 
                color: #e74c3c; 
                padding: 12px 25px; 
                border-radius: 8px; 
                font-family: 'Courier New', monospace;
                text-shadow: 0 0 5px rgba(231, 76, 60, 0.5);
                box-shadow: 0 0 10px rgba(231, 76, 60, 0.2);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 16px;
                text-transform: uppercase;
                letter-spacing: 1px;"
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(231, 76, 60, 0.4)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(231, 76, 60, 0.2)';">
                <i class="fas fa-trash-alt" style="margin-right: 8px;"></i> Nullstill XP
            </button>
            <button id="toggleLockButton" class="action-button" onclick="toggleLock()" style="
                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                border: 2px solid #2ecc71; 
                color: #2ecc71; 
                padding: 12px 25px; 
                border-radius: 8px; 
                font-family: 'Courier New', monospace;
                text-shadow: 0 0 5px rgba(46, 204, 113, 0.5);
                box-shadow: 0 0 10px rgba(46, 204, 113, 0.2);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 16px;
                text-transform: uppercase;
                letter-spacing: 1px;"
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(46, 204, 113, 0.4)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(46, 204, 113, 0.2)';">
                <i class="fas fa-lock" style="margin-right: 8px;"></i> <span id="lockButtonText">Lås redigering</span>
            </button>
            <button id="toggleDeleteProtectionButton" class="action-button" onclick="toggleDeleteProtection()" style="
                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                border: 2px solid #f39c12; 
                color: #f39c12; 
                padding: 12px 25px; 
                border-radius: 8px; 
                font-family: 'Courier New', monospace;
                text-shadow: 0 0 5px rgba(243, 156, 18, 0.5);
                box-shadow: 0 0 10px rgba(243, 156, 18, 0.2);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 16px;
                text-transform: uppercase;
                letter-spacing: 1px;"
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(243, 156, 18, 0.4)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(243, 156, 18, 0.2)';">
                <i class="fas fa-shield-alt" style="margin-right: 8px;"></i> <span id="deleteProtectionText">Slå på slettebeskyttelse</span>
            </button>
        </div>
    </div>

    <div id="achievementsModal" class="modal">
        <div class="modal-content">
            <span class="close">X</span>
            <div class="modal-header">
                <h2 id="studentName"></h2>
            </div>
            <div id="achievementsContent">
                <!-- Achievement content will be generated here -->
            </div>
        </div>
    </div>

    <div id="oasisWelcomeModal" class="modal" style="border: none; background: transparent; box-shadow: none; opacity: 1;">
        <div class="modal-content border-pulse" style="opacity: 0; transform: translateY(-20px); transition: opacity 0.3s ease, transform 0.3s ease; max-width: 600px; background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%); border: 4px solid #3498db; color: #ffffff; border-radius: 15px; padding: 30px; box-shadow: 0 0 30px rgba(52, 152, 219, 0.8), 0 0 15px rgba(52, 152, 219, 0.5) inset; text-align: center; font-family: 'Courier New', monospace; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at center, rgba(52, 152, 219, 0.1) 0%, rgba(0, 0, 0, 0) 70%), repeating-linear-gradient(45deg, rgba(52, 152, 219, 0.05) 0px, rgba(52, 152, 219, 0.05) 2px, transparent 2px, transparent 4px); animation: moveBackground 20s linear infinite; z-index: 0;"></div>
            <button onclick="closeOasisModal()" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #3498db; font-size: 20px; cursor: pointer; z-index: 2; transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.2)'; this.style.textShadow='0 0 10px rgba(52, 152, 219, 0.8)';" onmouseout="this.style.transform='scale(1)'; this.style.textShadow='none';">×</button>
            <h2 style="margin: 0 0 20px 0; color: #3498db; text-shadow: 0 0 10px rgba(52, 152, 219, 0.5); font-size: 28px; letter-spacing: 2px; text-transform: uppercase; z-index: 1; position: relative;">VELKOMMEN TIL OASIS</h2>
            <div style="margin-bottom: 20px; z-index: 1; position: relative;">
                <p style="font-size: 18px; line-height: 1.6; margin-bottom: 15px; color: #e0e0e0; text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);">
                    OASIS Level Up Facility er et høyteknologisk treningssenter designet av James Halliday, skaperen av OASIS. Her kan avatarer forbedre sine ferdigheter og forberede seg på utfordringene som venter i den virtuelle verdenen.
                </p>
                <p style="font-size: 18px; line-height: 1.6; margin-bottom: 15px; color: #e0e0e0; text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);">
                    I dette senteret kan du spore fremgangen til hver avatar, tildele erfaringspoeng (EXP), og låse opp prestasjoner etter hvert som ferdighetene forbedres. Hver ferdighet representerer en unik evne som er avgjørende for å mestre OASIS.
                </p>
                <blockquote style="font-style: italic; border-left: 3px solid #3498db; padding-left: 15px; margin: 20px 0; color: #3498db; text-shadow: 0 0 5px rgba(52, 152, 219, 0.3);">
                    "Virkeligheten er et spill, og mestrer du ferdighetene dine, kan du vinne det." — James Halliday
                </blockquote>
            </div>
            
            <!-- Legg til facility-bildet -->
            <div style="margin-bottom: 20px; z-index: 1; position: relative;">
                <img src="facility.jpg" alt="OASIS Facility" style="width: 100%; max-width: 500px; border-radius: 10px; box-shadow: 0 0 20px rgba(52, 152, 219, 0.5); border: 2px solid #3498db;">
            </div>
            
            <button onclick="closeOasisModal()" style="background: linear-gradient(180deg, #3498db, #2980b9); border: none; color: white; padding: 12px 30px; border-radius: 5px; font-size: 16px; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; font-weight: bold; margin-top: 10px; z-index: 1; position: relative; box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 20px rgba(52, 152, 219, 0.5)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.3)';">ENTER OASIS</button>
        </div>
    </div>

    <div id="itemBagModal" class="modal" style="background: transparent; border: none; padding: 0; box-shadow: none; opacity: 1;">
        <div class="modal-content" style="
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 40, 0.95));
            border: 2px solid #0ff;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3), 0 0 15px rgba(0, 255, 255, 0.2) inset;
            max-width: 1200px;
            position: relative;
            overflow: hidden;
            padding: 30px;
            border-radius: 15px;
        ">
            <!-- Holografisk effekt overlay -->
            <div style="
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: 
                    repeating-linear-gradient(90deg, rgba(0, 255, 255, 0.03) 0px, rgba(0, 255, 255, 0.03) 1px, transparent 1px, transparent 10px),
                    repeating-linear-gradient(0deg, rgba(0, 255, 255, 0.03) 0px, rgba(0, 255, 255, 0.03) 1px, transparent 1px, transparent 10px);
                pointer-events: none;
                z-index: 1;
            "></div>
            
            <!-- Glødende kant effekt -->
            <div style="
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                border-radius: 17px;
                background: linear-gradient(45deg, #0ff, transparent, #f0f, transparent, #0ff);
                background-size: 400% 400%;
                z-index: -1;
                animation: glowingBorder 8s linear infinite;
                opacity: 0.6;
            "></div>
            
            <button class="close-button" onclick="closeItemBagModal()" style="
                position: absolute;
                right: 15px;
                top: 15px;
                background: none;
                border: 2px solid #0ff;
                color: #0ff;
                font-size: 18px;
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 10;
                transition: all 0.3s ease;
                text-shadow: 0 0 5px #0ff;
                box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
            " onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 15px rgba(0, 255, 255, 0.5)';" 
               onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 255, 0.3)';">X</button>
            
            <div style="position: relative; z-index: 2;">
                <h2 style="
                    color: #0ff;
                    font-size: 28px;
                    text-transform: uppercase;
                    letter-spacing: 3px;
                    margin-bottom: 25px;
                    text-align: center;
                    text-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
                    font-family: 'Courier New', monospace;
                    border-bottom: 2px solid #0ff;
                    padding-bottom: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                ">
                    <i class="fas fa-cube" style="margin-right: 15px; font-size: 24px;"></i>
                    OASIS INVENTORY SYSTEM v2.0
                    <i class="fas fa-cube" style="margin-left: 15px; font-size: 24px;"></i>
                </h2>
                
                <!-- Statistikk panel -->
                <div style="
                    display: flex;
                    justify-content: space-between;
                    margin-bottom: 20px;
                    background: rgba(0, 0, 0, 0.5);
                    border: 1px solid #0ff;
                    border-radius: 10px;
                    padding: 15px;
                ">
                    <div style="text-align: center; flex: 1;">
                        <div style="color: #0ff; font-size: 14px; margin-bottom: 5px;">SLOTS</div>
                        <div style="color: white; font-size: 18px; font-weight: bold;" id="itemSlots">0/20</div>
                    </div>
                    <div style="text-align: center; flex: 2; border-left: 1px solid rgba(0, 255, 255, 0.3); border-right: 1px solid rgba(0, 255, 255, 0.3);">
                        <div style="color: #0ff; font-size: 14px; margin-bottom: 5px;">UTSTYRSBONUSER</div>
                        <div id="statBonuses" style="display: flex; justify-content: space-around; flex-wrap: wrap; font-size: 14px;">
                            <div style="margin: 0 10px;"><span>INT: </span><span style="color: #0f0;" id="intBonus">+0</span></div>
                            <div style="margin: 0 10px;"><span>TEK: </span><span style="color: #0f0;" id="tekBonus">+0</span></div>
                            <div style="margin: 0 10px;"><span>STA: </span><span style="color: #0f0;" id="staBonus">+0</span></div>
                            <div style="margin: 0 10px;"><span>KAR: </span><span style="color: #0f0;" id="karBonus">+0</span></div>
                            <div style="margin: 0 10px;"><span>KRE: </span><span style="color: #0f0;" id="kreBonus">+0</span></div>
                            <div style="margin: 0 10px;"><span>FLA: </span><span style="color: #0f0;" id="flaBonus">+0</span></div>
                        </div>
                    </div>
                    <div style="text-align: center; flex: 1;">
                        <div style="color: #0ff; font-size: 14px; margin-bottom: 5px;">XP</div>
                        <div style="color: white; font-size: 18px; font-weight: bold;" id="powerLevel">0</div>
                    </div>
                </div>
                
                <!-- Ny layout med equipment slots og inventory -->
                <div style="display: flex; gap: 20px;">
                    <!-- Equipment slots panel -->
                    <div id="equipmentPanel" style="
                        width: 220px;
                        background: rgba(0, 0, 0, 0.5);
                        border: 1px solid rgba(0, 255, 255, 0.3);
                        border-radius: 10px;
                        padding: 15px;
                        display: flex;
                        flex-direction: column;
                        gap: 15px;
                    ">
                        <div style="text-align: center; margin-bottom: 10px;">
                            <div style="color: #0ff; font-size: 16px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;">
                                <i class="fas fa-user-astronaut" style="margin-right: 5px;"></i> Utstyr
                            </div>
                            <div style="color: rgba(255, 255, 255, 0.7); font-size: 12px;">
                                Dra gjenstander hit for å utstyre dem
                            </div>
                        </div>
                        
                        <!-- Equipment slots -->
                        <div class="equipment-slot" data-slot="head" style="
                            height: 80px;
                            background: rgba(0, 0, 0, 0.3);
                            border: 1px dashed rgba(0, 255, 255, 0.3);
                            border-radius: 8px;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            <div style="font-size: 24px; color: rgba(255, 255, 255, 0.3); margin-bottom: 5px;">🪖</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">Hode</div>
                        </div>
                        
                        <div class="equipment-slot" data-slot="chest" style="
                            height: 80px;
                            background: rgba(0, 0, 0, 0.3);
                            border: 1px dashed rgba(0, 255, 255, 0.3);
                            border-radius: 8px;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            <div style="font-size: 24px; color: rgba(255, 255, 255, 0.3); margin-bottom: 5px;">🛡️</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">Bryst</div>
                        </div>
                        
                        <div class="equipment-slot" data-slot="hands" style="
                            height: 80px;
                            background: rgba(0, 0, 0, 0.3);
                            border: 1px dashed rgba(0, 255, 255, 0.3);
                            border-radius: 8px;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            <div style="font-size: 24px; color: rgba(255, 255, 255, 0.3); margin-bottom: 5px;">🧤</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">Hender</div>
                        </div>
                        
                        <div class="equipment-slot" data-slot="legs" style="
                            height: 80px;
                            background: rgba(0, 0, 0, 0.3);
                            border: 1px dashed rgba(0, 255, 255, 0.3);
                            border-radius: 8px;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            <div style="font-size: 24px; color: rgba(255, 255, 255, 0.3); margin-bottom: 5px;">👖</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">Bein</div>
                        </div>
                        
                        <div class="equipment-slot" data-slot="feet" style="
                            height: 80px;
                            background: rgba(0, 0, 0, 0.3);
                            border: 1px dashed rgba(0, 255, 255, 0.3);
                            border-radius: 8px;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            <div style="font-size: 24px; color: rgba(255, 255, 255, 0.3); margin-bottom: 5px;">👟</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">Føtter</div>
                        </div>
                        
                        <div class="equipment-slot" data-slot="accessory" style="
                            height: 80px;
                            background: rgba(0, 0, 0, 0.3);
                            border: 1px dashed rgba(0, 255, 255, 0.3);
                            border-radius: 8px;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            <div style="font-size: 24px; color: rgba(255, 255, 255, 0.3); margin-bottom: 5px;">💍</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">Tilbehør</div>
                        </div>
                        
                        <!-- Equipment info -->
                        <div style="
                            margin-top: 10px;
                            padding: 10px;
                            background: rgba(0, 0, 0, 0.3);
                            border: 1px solid rgba(0, 255, 255, 0.3);
                            border-radius: 8px;
                        ">
                            <div style="color: #0ff; font-size: 14px; margin-bottom: 8px; text-align: center;">UTSTYR INFO</div>
                            <div style="font-size: 12px; color: white; text-align: center; line-height: 1.4;">
                                Dra og slipp gjenstander fra inventaret til utstyrslotene for å utstyre dem.
                                <br><br>
                                Utstyrt utstyr gir bonuser til ferdighetene dine.
                            </div>
                        </div>
                    </div>
                    
                    <!-- Inventory panel -->
                    <div style="flex: 1;">
                        <div id="itemsContainer" class="items-container" style="
                            display: grid;
                            grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
                            gap: 12px;
                            max-height: 620px;
                            overflow-y: auto;
                            padding: 15px;
                            background: rgba(0, 0, 0, 0.5);
                            border: 1px solid rgba(0, 255, 255, 0.3);
                            border-radius: 10px;
                            margin-bottom: 20px;
                            scrollbar-width: thin;
                            scrollbar-color: #0ff rgba(0, 0, 0, 0.5);
                        ">
                            <!-- Items vil bli lagt til her dynamisk -->
                        </div>
                        
                        <div class="item-actions" style="
                            display: flex;
                            justify-content: center;
                            gap: 15px;
                            margin-top: 20px;
                        ">
                            <button class="action-button" style="
                                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                                border: 2px solid #0ff; 
                                color: #0ff; 
                                padding: 12px 25px; 
                                border-radius: 8px; 
                                font-family: 'Courier New', monospace;
                                text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
                                box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
                                transition: all 0.3s ease;
                                font-size: 16px;
                                text-transform: uppercase;
                                letter-spacing: 1px;
                                position: relative;
                                overflow: hidden;"
                                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(0, 255, 255, 0.4)';"
                                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 255, 0.2)';"
                                onclick="buyItem()">
                                <i class="fas fa-dice" style="margin-right: 8px;"></i> Trekk tilfeldig gjenstand
                                <span style="
                                    position: absolute;
                                    top: 0;
                                    left: -100%;
                                    width: 100%;
                                    height: 100%;
                                    background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.3), transparent);
                                    animation: shineEffect 2s infinite;
                                "></span>
                            </button>
                            <button class="action-button" style="
                                background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                                border: 2px solid #ff3366; 
                                color: #ff3366; 
                                padding: 12px 25px; 
                                border-radius: 8px; 
                                font-family: 'Courier New', monospace;
                                text-shadow: 0 0 5px rgba(255, 51, 102, 0.5);
                                box-shadow: 0 0 10px rgba(255, 51, 102, 0.2);
                                transition: all 0.3s ease;
                                font-size: 16px;
                                text-transform: uppercase;
                                letter-spacing: 1px;"
                                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(255, 51, 102, 0.4)';"
                                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(255, 51, 102, 0.2)';"
                                onclick="clearAllItems()">
                                <i class="fas fa-trash-alt" style="margin-right: 8px;"></i> Tøm ryggsekk
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Informasjonspanel nederst -->
                <div style="
                    margin-top: 20px;
                    padding: 10px;
                    background: rgba(0, 0, 0, 0.5);
                    border: 1px solid rgba(0, 255, 255, 0.3);
                    border-radius: 8px;
                    font-size: 14px;
                    color: rgba(255, 255, 255, 0.7);
                    text-align: center;
                ">
                    <i class="fas fa-info-circle" style="color: #0ff; margin-right: 5px;"></i>
                    Gjenstander kan brukes til å forbedre ferdighetene dine eller utstyres for permanente bonuser.
                </div>
            </div>
        </div>
    </div>

    <!-- Bruktmarked Modal -->
    <div id="marketplaceModal" class="modal" style="display: none;">
        <!-- Denne modalen vil bli erstattet av den kombinerte modalen -->
    </div>

    <!-- Legg til CSS for animasjoner -->
    <style>
        @keyframes glowingBorder {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes shineEffect {
            0% { left: -100%; }
            20% { left: 100%; }
            100% { left: 100%; }
        }
        
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 10px rgba(241, 196, 15, 0.5); }
            50% { box-shadow: 0 0 20px rgba(241, 196, 15, 0.8), 0 0 30px rgba(241, 196, 15, 0.4); }
            100% { box-shadow: 0 0 10px rgba(241, 196, 15, 0.5); }
        }
        
        /* Tilpasset scrollbar for cyberpunk-tema */
        .items-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .items-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }
        
        .items-container::-webkit-scrollbar-thumb {
            background: #0ff;
            border-radius: 4px;
            box-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
        }
        
        .items-container::-webkit-scrollbar-thumb:hover {
            background: #00cccc;
        }
        
        /* Tabs styling */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(241, 196, 15, 0.3);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            position: relative;
            margin-right: 5px;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }
        
        .tab.active {
            color: #f1c40f;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #f1c40f;
            border-bottom: none;
            text-shadow: 0 0 5px rgba(241, 196, 15, 0.7);
            z-index: 1;
        }
        
        .tab:not(.active) {
            color: rgba(241, 196, 15, 0.7);
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(241, 196, 15, 0.3);
            border-bottom: none;
        }
        
        .tab:not(.active):hover {
            color: #f1c40f;
            background: rgba(0, 0, 0, 0.4);
            border-color: rgba(241, 196, 15, 0.5);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>

    <!-- Legg til kombinert shop og marketplace modal -->
    <div id="combinedShopModal" class="modal" style="background: transparent; border: none; padding: 0; box-shadow: none; opacity: 1; display: none;">
        <div class="modal-content" style="
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 40, 0.95));
            border: 2px solid #f1c40f;
            box-shadow: 0 0 30px rgba(241, 196, 15, 0.3), 0 0 15px rgba(241, 196, 15, 0.2) inset;
            max-width: 70vw;
            width: 70vw;
            position: relative;
            overflow: hidden;
            padding: 15px;
            border-radius: 15px;
        ">
            <!-- Holografisk effekt overlay -->
            <div style="
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: 
                    repeating-linear-gradient(90deg, rgba(241, 196, 15, 0.03) 0px, rgba(241, 196, 15, 0.03) 1px, transparent 1px, transparent 10px),
                    repeating-linear-gradient(0deg, rgba(241, 196, 15, 0.03) 0px, rgba(241, 196, 15, 0.03) 1px, transparent 1px, transparent 10px);
                pointer-events: none;
                z-index: 1;
            "></div>
            
            <!-- Glødende kant effekt -->
            <div style="
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                border-radius: 17px;
                background: linear-gradient(45deg, #f1c40f, transparent, #e74c3c, transparent, #f1c40f);
                background-size: 400% 400%;
                z-index: -1;
                animation: glowingBorder 8s linear infinite;
                opacity: 0.6;
            "></div>
            
            <button class="close-button" onclick="closeCombinedShopModal()" style="
                position: absolute;
                right: 15px;
                top: 15px;
                background: none;
                border: 2px solid #f1c40f;
                color: #f1c40f;
                font-size: 18px;
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 10;
                transition: all 0.3s ease;
                text-shadow: 0 0 5px #f1c40f;
                box-shadow: 0 0 10px rgba(241, 196, 15, 0.3);
            " onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 15px rgba(241, 196, 15, 0.5)';" 
               onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(241, 196, 15, 0.3)';">X</button>
            
            <div style="position: relative; z-index: 2;">
                <h2 style="
                    color: #f1c40f;
                    font-size: 28px;
                    text-transform: uppercase;
                    letter-spacing: 3px;
                    margin-bottom: 25px;
                    text-align: center;
                    text-shadow: 0 0 10px rgba(241, 196, 15, 0.7);
                    font-family: 'Courier New', monospace;
                    padding-bottom: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                ">
                    <i class="fas fa-store" style="margin-right: 15px; font-size: 24px;"></i>
                    OASIS HANDELSSENTER
                    <i class="fas fa-exchange-alt" style="margin-left: 15px; font-size: 24px;"></i>
                </h2>

                <!-- Tabs for å veksle mellom butikk og bruktmarked -->
                <div class="tabs">
                    <div class="tab active" data-tab="shop">
                        <i class="fas fa-store" style="margin-right: 8px;"></i> BUTIKK
                    </div>
                    <div class="tab" data-tab="marketplace">
                        <i class="fas fa-exchange-alt" style="margin-right: 8px;"></i> BRUKTMARKED
                    </div>
                </div>

                <!-- Velg elev dropdown -->
                <div style="margin-bottom: 20px; text-align: center;">
                    <select id="combinedStudentSelect" style="
                        background: rgba(0, 0, 0, 0.7);
                        border: 2px solid #f1c40f;
                        color: #f1c40f;
                        padding: 10px 20px;
                        border-radius: 8px;
                        font-family: 'Courier New', monospace;
                        font-size: 16px;
                        cursor: pointer;
                        width: 80%;
                        max-width: 400px;
                        text-align: center;
                        margin-bottom: 15px;
                    ">
                        <option value="">Velg elev...</option>
                    </select>
                    <div id="combinedStudentExpDisplay" style="
                        color: #f1c40f;
                        font-size: 18px;
                        margin-top: 10px;
                        text-shadow: 0 0 5px rgba(241, 196, 15, 0.5);
                    "></div>
                </div>
                
                <!-- Shop tab content -->
                <div id="shopTabContent" class="tab-content active">
                    <div id="shopItemsContainer" class="items-container" style="
                        display: grid;
                        grid-template-columns: repeat(5, 1fr);
                        gap: 8px;
                        max-height: 400px;
                        overflow-y: auto;
                        padding: 8px;
                        background: rgba(0, 0, 0, 0.5);
                        border: 1px solid rgba(241, 196, 15, 0.3);
                        border-radius: 10px;
                        margin-bottom: 20px;
                        scrollbar-width: thin;
                        scrollbar-color: #f1c40f rgba(0, 0, 0, 0.5);
                        justify-content: center;
                    ">
                        <!-- Shop items will be added here dynamically -->
                    </div>
                </div>
                
                <!-- Marketplace tab content -->
                <div id="marketplaceTabContent" class="tab-content">
                    <div id="marketplaceItems" class="items-grid" style="
                        display: grid;
                        grid-template-columns: repeat(5, 1fr);
                        gap: 8px;
                        max-height: 400px;
                        overflow-y: auto;
                        padding: 8px;
                        background: rgba(0, 0, 0, 0.5);
                        border: 1px solid rgba(241, 196, 15, 0.3);
                        border-radius: 10px;
                        margin-bottom: 20px;
                        scrollbar-width: thin;
                        scrollbar-color: #f1c40f rgba(0, 0, 0, 0.5);
                        justify-content: center;
                    ">
                        <!-- Marketplace items will be added here dynamically -->
                    </div>
                    
                    <div class="marketplace-info" style="
                        background: rgba(0, 0, 0, 0.3);
                        border: 1px solid rgba(241, 196, 15, 0.3);
                        border-radius: 8px;
                        padding: 15px;
                        margin-top: 10px;
                    ">
                        <h3 style="color: #f1c40f; margin-top: 0;">Om bruktmarkedet</h3>
                        <p style="color: rgba(255, 255, 255, 0.8);">Her kan du kjøpe og selge gjenstander med andre elever. Bruk XP som valuta!</p>
                        <p style="color: rgba(255, 255, 255, 0.8);">For å selge en gjenstand, gå til din ryggsekk og klikk på "Selg"-knappen ved siden av gjenstanden.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Legg til shop modal før body-taggen -->
    <div id="shopModal" class="modal" style="display: none;">
        <!-- Denne modalen vil bli erstattet av den kombinerte modalen -->
    </div>

    <div id="oasisUpdateModal" class="modal">
        <button class="close-update-modal" onclick="closeOASISUpdateModal()">&times;</button>
        <div class="update-header">
            <h2>OASIS Update</h2>
            <div class="update-date">4. mars 2024</div>
        </div>
        <div class="update-content">
            <div class="update-section">
                <h3>Legendariske karakterer har ankommet Level Up-fasiliteten!</h3>
                <p>Vi er begeistret over å kunngjøre at noen av OASIS' mest ikoniske karakterer har ankommet Level Up-fasiliteten. Disse legendariske figurene har kommet for å dele sin kunnskap og utfordre deg med spennende oppgaver.</p>
                
                <div class="update-image-container">
                    <img src="images/npcs/NPC.jpg" alt="OASIS NPCs" class="update-image">
                </div>
                
                <h4>Karakterene som har ankommet:</h4>
                <ul>
                    <li><span class="highlight">Wade Watts (Parzival)</span> - Den mest berømte egg hunteren i OASIS' historie</li>
                    <li><span class="highlight">Art3mis</span> - Den mystiske og dyktige egg hunteren</li>
                    <li><span class="highlight">Aech</span> - Den legendariske mekanikeren og raceren</li>
                    <li><span class="highlight">Shoto</span> - Den mystiske ninja-mesteren</li>
                    <li><span class="highlight">I-R0k</span> - Den fryktede PvP-mesteren</li>
                    <li><span class="highlight">Ogden Morrow</span> - OASIS' medgrunnlegger og legendarisk programmerer</li>
                </ul>
                
                <p>Hver karakter har bringt med seg unike oppdrag og utfordringer, designet for å teste og forbedre dine ferdigheter. Ved å fullføre disse oppdragene kan du tjene betydelige mengder EXP og få tilgang til spesielle belønninger.</p>
                
                <p>Husk at hver karakter har sitt eget spesialområde og unike oppdrag, så utforsk dem alle for å maksimere din læring og utvikling!</p>
            </div>
        </div>
        <div class="update-footer">
            <i class="fas fa-code"></i> Level Up System v1.0
        </div>
    </div>

    <script>
    function openOASISUpdateModal() {
        const modal = document.getElementById('oasisUpdateModal');
        
        // Fjern eksisterende backdrop hvis den finnes
        let backdrop = document.getElementById('modal-backdrop');
        if (backdrop) {
            backdrop.remove();
        }
        
        // Opprett ny backdrop
        backdrop = document.createElement('div');
        backdrop.id = 'modal-backdrop';
        backdrop.className = 'modal-backdrop';
        document.body.appendChild(backdrop);
        
        // Vis backdrop med en liten forsinkelse for å aktivere overgangseffekten
        setTimeout(() => {
            backdrop.classList.add('show');
        }, 10);
        
        // Vis modal
        modal.style.display = 'block';
        
        // Legg til show-klassen for å aktivere animasjonen
        setTimeout(() => {
            modal.classList.add('show');
        }, 10);
        
        // Legg til klikk-hendelse for å lukke modal ved klikk på backdrop
        backdrop.addEventListener('click', function() {
            closeOASISUpdateModal();
        });
    }

    function closeOASISUpdateModal() {
        const modal = document.getElementById('oasisUpdateModal');
        if (modal) {
            // Legg til en fade-out animasjon
            modal.classList.remove('show');
            
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }
        
        // Fjern backdrop med fade-out effekt
        const backdrop = document.getElementById('modal-backdrop');
        if (backdrop) {
            backdrop.classList.remove('show');
            setTimeout(() => {
                backdrop.remove();
            }, 300);
        }
    }
    </script>

    <!-- Modal for å legge til spillere -->
    <div id="addPlayersModal" class="modal" style="background: transparent; border: none; padding: 0; box-shadow: none; opacity: 1; display: none;">
        <div class="modal-content" style="
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 40, 0.95));
            border: 2px solid #27ae60;
            box-shadow: 0 0 30px rgba(39, 174, 96, 0.3), 0 0 15px rgba(39, 174, 96, 0.2) inset;
            max-width: 600px;
            position: relative;
            overflow: hidden;
            padding: 30px;
            border-radius: 15px;
        ">
            <!-- Holografisk effekt overlay -->
            <div style="
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: 
                    repeating-linear-gradient(90deg, rgba(39, 174, 96, 0.03) 0px, rgba(39, 174, 96, 0.03) 1px, transparent 1px, transparent 10px),
                    repeating-linear-gradient(0deg, rgba(39, 174, 96, 0.03) 0px, rgba(39, 174, 96, 0.03) 1px, transparent 1px, transparent 10px);
                pointer-events: none;
                z-index: 1;
            "></div>
            
            <!-- Glødende kant effekt -->
            <div style="
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                border-radius: 17px;
                background: linear-gradient(45deg, #27ae60, transparent, #2ecc71, transparent, #27ae60);
                background-size: 400% 400%;
                z-index: -1;
                animation: glowingBorder 8s linear infinite;
                opacity: 0.6;
            "></div>
            
            <button class="close-button" onclick="closeAddPlayersModal()" style="
                position: absolute;
                right: 15px;
                top: 15px;
                background: none;
                border: 2px solid #27ae60;
                color: #27ae60;
                font-size: 18px;
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 10;
                transition: all 0.3s ease;
                text-shadow: 0 0 5px #27ae60;
                box-shadow: 0 0 10px rgba(39, 174, 96, 0.3);
            " onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 15px rgba(39, 174, 96, 0.5)';" 
               onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(39, 174, 96, 0.3)';">X</button>
            
            <div style="position: relative; z-index: 2;">
                <h2 style="
                    color: #27ae60;
                    font-size: 28px;
                    text-transform: uppercase;
                    letter-spacing: 3px;
                    margin-bottom: 25px;
                    text-align: center;
                    text-shadow: 0 0 10px rgba(39, 174, 96, 0.7);
                    font-family: 'Courier New', monospace;
                    border-bottom: 2px solid #27ae60;
                    padding-bottom: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                ">
                    <i class="fas fa-user-plus" style="margin-right: 15px; font-size: 24px;"></i>
                    LEGG TIL SPILLERE
                    <i class="fas fa-user-plus" style="margin-left: 15px; font-size: 24px;"></i>
                </h2>
                
                <div style="margin-bottom: 20px;">
                    <p style="
                        color: rgba(255, 255, 255, 0.8);
                        text-align: center;
                        margin-bottom: 20px;
                        font-family: 'Courier New', monospace;
                    ">
                        Skriv inn navn på spillere du vil legge til i OASIS. Bruk komma eller linjeskift for å skille flere navn.
                    </p>
                    
                    <textarea id="playerNamesInput" style="
                        width: 100%;
                        height: 120px;
                        background: rgba(0, 0, 0, 0.5);
                        border: 2px solid #27ae60;
                        border-radius: 10px;
                        color: #fff;
                        padding: 15px;
                        font-family: 'Courier New', monospace;
                        resize: none;
                        outline: none;
                        transition: all 0.3s ease;
                        box-shadow: 0 0 10px rgba(39, 174, 96, 0.2) inset;
                    " placeholder="F.eks: Spiller1, Spiller2, Spiller3&#10;eller&#10;Spiller1&#10;Spiller2&#10;Spiller3" 
                    onmouseover="this.style.boxShadow='0 0 15px rgba(39, 174, 96, 0.4) inset';" 
                    onmouseout="this.style.boxShadow='0 0 10px rgba(39, 174, 96, 0.2) inset';"></textarea>
                </div>
                
                <div style="display: flex; justify-content: center; gap: 15px;">
                    <button onclick="addMultiplePlayers()" style="
                        background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                        border: 2px solid #27ae60; 
                        color: #27ae60; 
                        padding: 12px 25px; 
                        border-radius: 8px; 
                        font-family: 'Courier New', monospace;
                        text-shadow: 0 0 5px rgba(39, 174, 96, 0.5);
                        box-shadow: 0 0 10px rgba(39, 174, 96, 0.2);
                        cursor: pointer;
                        transition: all 0.3s ease;
                        font-size: 16px;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                        position: relative;
                        overflow: hidden;"
                        onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(39, 174, 96, 0.4)';"
                        onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(39, 174, 96, 0.2)';">
                        <i class="fas fa-user-plus" style="margin-right: 8px;"></i> Lagre spillere
                        <span style="
                            position: absolute;
                            top: 0;
                            left: -100%;
                            width: 100%;
                            height: 100%;
                            background: linear-gradient(90deg, transparent, rgba(39, 174, 96, 0.3), transparent);
                            animation: shineEffect 2s infinite;
                        "></span>
                    </button>
                    <button onclick="closeAddPlayersModal()" style="
                        background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                        border: 2px solid #e74c3c; 
                        color: #e74c3c; 
                        padding: 12px 25px; 
                        border-radius: 8px; 
                        font-family: 'Courier New', monospace;
                        text-shadow: 0 0 5px rgba(231, 76, 60, 0.5);
                        box-shadow: 0 0 10px rgba(231, 76, 60, 0.2);
                        cursor: pointer;
                        transition: all 0.3s ease;
                        font-size: 16px;
                        text-transform: uppercase;
                        letter-spacing: 1px;"
                        onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(231, 76, 60, 0.4)';"
                        onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(231, 76, 60, 0.2)';">
                        <i class="fas fa-times" style="margin-right: 8px;"></i> Avbryt
                    </button>
                </div>
                
                <!-- Informasjonspanel nederst -->
                <div style="
                    margin-top: 20px;
                    padding: 10px;
                    background: rgba(0, 0, 0, 0.5);
                    border: 1px solid rgba(39, 174, 96, 0.3);
                    border-radius: 8px;
                    font-size: 14px;
                    color: rgba(255, 255, 255, 0.7);
                    text-align: center;
                ">
                    <i class="fas fa-info-circle" style="color: #27ae60; margin-right: 5px;"></i>
                    Alle nye spillere starter med 0 i alle ferdigheter og 0 XP.
                </div>
            </div>
        </div>
    </div>

    <!-- PIN-kode modal -->
    <div id="pinModal" class="modal" style="background: transparent; border: none; padding: 0; box-shadow: none; opacity: 1; display: none;">
        <div class="modal-content" style="
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 40, 0.95));
            border: 2px solid #3498db;
            box-shadow: 0 0 30px rgba(52, 152, 219, 0.3), 0 0 15px rgba(52, 152, 219, 0.2) inset;
            max-width: 400px;
            position: relative;
            overflow: hidden;
            padding: 30px;
            border-radius: 15px;
        ">
            <!-- Holografisk effekt overlay -->
            <div style="
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: 
                    repeating-linear-gradient(90deg, rgba(52, 152, 219, 0.03) 0px, rgba(52, 152, 219, 0.03) 1px, transparent 1px, transparent 10px),
                    repeating-linear-gradient(0deg, rgba(52, 152, 219, 0.03) 0px, rgba(52, 152, 219, 0.03) 1px, transparent 1px, transparent 10px);
                pointer-events: none;
                z-index: 1;
            "></div>
            
            <!-- Glødende kant effekt -->
            <div style="
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                border-radius: 17px;
                background: linear-gradient(45deg, #3498db, transparent, #2980b9, transparent, #3498db);
                background-size: 400% 400%;
                z-index: -1;
                animation: glowingBorder 8s linear infinite;
                opacity: 0.6;
            "></div>
            
            <button class="close-button" onclick="closePinModal()" style="
                position: absolute;
                right: 15px;
                top: 15px;
                background: none;
                border: 2px solid #3498db;
                color: #3498db;
                font-size: 18px;
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 10;
                transition: all 0.3s ease;
                text-shadow: 0 0 5px #3498db;
                box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
            " onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.5)';" 
               onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(52, 152, 219, 0.3)';">X</button>
            
            <div style="position: relative; z-index: 2;">
                <h2 style="
                    color: #3498db;
                    font-size: 28px;
                    text-transform: uppercase;
                    letter-spacing: 3px;
                    margin-bottom: 25px;
                    text-align: center;
                    text-shadow: 0 0 10px rgba(52, 152, 219, 0.7);
                    font-family: 'Courier New', monospace;
                    border-bottom: 2px solid #3498db;
                    padding-bottom: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                ">
                    <i class="fas fa-shield-alt" style="margin-right: 15px; font-size: 24px;"></i>
                    SIKKERHETSKONTROLL
                    <i class="fas fa-shield-alt" style="margin-left: 15px; font-size: 24px;"></i>
                </h2>
                
                <div style="margin-bottom: 20px;">
                    <p style="
                        color: rgba(255, 255, 255, 0.8);
                        text-align: center;
                        margin-bottom: 20px;
                        font-family: 'Courier New', monospace;
                    ">
                        Skriv inn PIN-koden for å fortsette med denne handlingen.
                    </p>
                    
                    <div style="
                        display: flex;
                        justify-content: center;
                        gap: 10px;
                        margin-bottom: 20px;
                    ">
                        <input type="password" id="pinInput" maxlength="4" style="
                            width: 200px;
                            background: rgba(0, 0, 0, 0.5);
                            border: 2px solid #3498db;
                            border-radius: 10px;
                            color: #fff;
                            padding: 15px;
                            font-family: 'Courier New', monospace;
                            font-size: 24px;
                            text-align: center;
                            letter-spacing: 10px;
                            outline: none;
                            transition: all 0.3s ease;
                            box-shadow: 0 0 10px rgba(52, 152, 219, 0.2) inset;
                        " placeholder="****" 
                        onmouseover="this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.4) inset';" 
                        onmouseout="this.style.boxShadow='0 0 10px rgba(52, 152, 219, 0.2) inset';"
                        onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                    </div>
                    
                    <div id="pinError" style="
                        color: #e74c3c;
                        text-align: center;
                        margin-bottom: 20px;
                        font-family: 'Courier New', monospace;
                        display: none;
                    ">
                        <i class="fas fa-exclamation-triangle"></i> Feil PIN-kode. Prøv igjen.
                    </div>
                </div>
                
                <div style="display: flex; justify-content: center; gap: 15px;">
                    <button id="confirmPinButton" style="
                        background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                        border: 2px solid #3498db; 
                        color: #3498db; 
                        padding: 12px 25px; 
                        border-radius: 8px; 
                        font-family: 'Courier New', monospace;
                        text-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
                        box-shadow: 0 0 10px rgba(52, 152, 219, 0.2);
                        cursor: pointer;
                        transition: all 0.3s ease;
                        font-size: 16px;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                        position: relative;
                        overflow: hidden;"
                        onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.4)';"
                        onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(52, 152, 219, 0.2)';">
                        <i class="fas fa-check" style="margin-right: 8px;"></i> Bekreft
                        <span style="
                            position: absolute;
                            top: 0;
                            left: -100%;
                            width: 100%;
                            height: 100%;
                            background: linear-gradient(90deg, transparent, rgba(52, 152, 219, 0.3), transparent);
                            animation: shineEffect 2s infinite;
                        "></span>
                    </button>
                    <button onclick="closePinModal()" style="
                        background: linear-gradient(180deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9)); 
                        border: 2px solid #e74c3c; 
                        color: #e74c3c; 
                        padding: 12px 25px; 
                        border-radius: 8px; 
                        font-family: 'Courier New', monospace;
                        text-shadow: 0 0 5px rgba(231, 76, 60, 0.5);
                        box-shadow: 0 0 10px rgba(231, 76, 60, 0.2);
                        cursor: pointer;
                        transition: all 0.3s ease;
                        font-size: 16px;
                        text-transform: uppercase;
                        letter-spacing: 1px;"
                        onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(231, 76, 60, 0.4)';"
                        onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(231, 76, 60, 0.2)';">
                        <i class="fas fa-times" style="margin-right: 8px;"></i> Avbryt
                    </button>
                </div>
                
                <!-- Informasjonspanel nederst -->
                <div style="
                    margin-top: 20px;
                    padding: 10px;
                    background: rgba(0, 0, 0, 0.5);
                    border: 1px solid rgba(52, 152, 219, 0.3);
                    border-radius: 8px;
                    font-size: 14px;
                    color: rgba(255, 255, 255, 0.7);
                    text-align: center;
                ">
                    <i class="fas fa-info-circle" style="color: #3498db; margin-right: 5px;"></i>
                    Denne handlingen krever administratortilgang.
                </div>
            </div>
        </div>
    </div>

    <!-- Legg til NPC-modal -->
    <div id="npcModal" class="modal" style="background: transparent; border: none; padding: 0; box-shadow: none; opacity: 1; display: none;">
        <div class="modal-content" style="
            background: linear-gradient(135deg, rgba(16, 24, 48, 0.95) 0%, rgba(24, 36, 72, 0.95) 100%);
            border: 2px solid #3498db;
            box-shadow: 0 0 30px rgba(52, 152, 219, 0.3), 0 0 15px rgba(52, 152, 219, 0.2) inset;
            max-width: 80%;
            width: 80%;
            position: relative;
            overflow: hidden;
            padding: 30px;
            border-radius: 15px;
            max-height: 80vh;
            overflow-y: auto;
        ">
            <!-- Holografisk effekt overlay -->
            <div style="
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: 
                    repeating-linear-gradient(90deg, rgba(52, 152, 219, 0.03) 0px, rgba(52, 152, 219, 0.03) 1px, transparent 1px, transparent 10px),
                    repeating-linear-gradient(0deg, rgba(52, 152, 219, 0.03) 0px, rgba(52, 152, 219, 0.03) 1px, transparent 1px, transparent 10px);
                pointer-events: none;
                z-index: 1;
            "></div>
            
            <!-- Glødende kant effekt -->
            <div style="
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                border-radius: 17px;
                background: linear-gradient(45deg, #3498db, transparent, #2980b9, transparent, #3498db);
                background-size: 400% 400%;
                z-index: -1;
                animation: glowingBorder 8s linear infinite;
                opacity: 0.6;
            "></div>
            
            <button class="close-button" onclick="closeNPCPanel()" style="
                position: absolute;
                right: 15px;
                top: 15px;
                background: none;
                border: 2px solid #3498db;
                color: #3498db;
                font-size: 18px;
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 10;
                transition: all 0.3s ease;
                text-shadow: 0 0 5px #3498db;
                box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
            " onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 15px rgba(52, 152, 219, 0.5)';" 
               onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(52, 152, 219, 0.3)';">X</button>
            
            <div style="position: relative; z-index: 2;">
                <h2 style="
                    color: #3498db;
                    font-size: 28px;
                    text-transform: uppercase;
                    letter-spacing: 3px;
                    margin-bottom: 25px;
                    text-align: center;
                    text-shadow: 0 0 10px rgba(52, 152, 219, 0.7);
                    font-family: 'Courier New', monospace;
                    border-bottom: 2px solid #3498db;
                    padding-bottom: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                ">
                    <i class="fas fa-users" style="margin-right: 15px; font-size: 24px;"></i>
                    OASIS NPCer
                    <i class="fas fa-users" style="margin-left: 15px; font-size: 24px;"></i>
                </h2>
                
                <!-- Velg elev dropdown -->
                <div style="margin-bottom: 20px; text-align: center;">
                    <select id="npcStudentSelect" style="
                        background: rgba(0, 0, 0, 0.7);
                        border: 2px solid #3498db;
                        color: #3498db;
                        padding: 10px 20px;
                        border-radius: 8px;
                        font-family: 'Courier New', monospace;
                        font-size: 16px;
                        cursor: pointer;
                        width: 80%;
                        max-width: 400px;
                        text-align: center;
                        margin-bottom: 15px;
                    ">
                        <option value="">Velg elev...</option>
                    </select>
                </div>
                
                <!-- NPC Container -->
                <div id="npcContainer" style="
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 20px;
                    margin-top: 20px;
                ">
                    <!-- NPCer vil bli lagt til her dynamisk -->
                </div>
                
                <!-- Quest Container -->
                <div id="questContainer" style="
                    margin-top: 20px;
                    display: none;
                ">
                    <!-- Quests vil bli lagt til her dynamisk -->
                </div>
            </div>
        </div>
    </div>
</body>
</html>
